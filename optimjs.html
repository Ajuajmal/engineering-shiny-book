<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Using JavaScript | Engineering Production-Grade Shiny Apps</title>
  <meta name="description" content="Chapter 18 Using JavaScript | Engineering Production-Grade Shiny Apps" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Using JavaScript | Engineering Production-Grade Shiny Apps" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 18 Using JavaScript | Engineering Production-Grade Shiny Apps" />
  <meta name="github-repo" content="ThinkR-open/building-shiny-apps-workflow" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Using JavaScript | Engineering Production-Grade Shiny Apps" />
  
  <meta name="twitter:description" content="Chapter 18 Using JavaScript | Engineering Production-Grade Shiny Apps" />
  

<meta name="author" content="Colin Fay, Sébastien Rochette, Vincent Guyader, Cervan Girard" />


<meta name="date" content="2020-04-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="prev" href="optimizing-shiny-code.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-149994171-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-149994171-1');
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/thinkr.css" type="text/css" />
<link rel="stylesheet" href="css/style_gitbook.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Engineering Production-Grade Shiny Apps</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>I Building Successful Shiny Apps</b></span></li>
<li class="chapter" data-level="1" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html"><i class="fa fa-check"></i><b>1</b> About Successful Shiny Apps</a></li>
<li class="chapter" data-level="2" data-path="planning.html"><a href="planning.html"><i class="fa fa-check"></i><b>2</b> Planning Ahead</a></li>
<li class="chapter" data-level="3" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>3</b> Structuring your Project</a></li>
<li class="chapter" data-level="4" data-path="golem.html"><a href="golem.html"><i class="fa fa-check"></i><b>4</b> Introduction to <code>{golem}</code></a></li>
<li class="chapter" data-level="5" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>5</b> The workflow</a></li>
<li class="part"><span><b>II Step 1: Design</b></span></li>
<li class="chapter" data-level="6" data-path="matters.html"><a href="matters.html"><i class="fa fa-check"></i><b>6</b> UX Matters</a></li>
<li class="chapter" data-level="7" data-path="step-design.html"><a href="step-design.html"><i class="fa fa-check"></i><b>7</b> Don’t rush into coding</a></li>
<li class="chapter" data-level="8" data-path="css.html"><a href="css.html"><i class="fa fa-check"></i><b>8</b> A Gentle Introduction to CSS</a></li>
<li class="part"><span><b>III Step 2: Prototype</b></span></li>
<li class="chapter" data-level="9" data-path="setting-up-for-success-with-golem.html"><a href="setting-up-for-success-with-golem.html"><i class="fa fa-check"></i><b>9</b> Setting up for success with <code>{golem}</code></a></li>
<li class="chapter" data-level="10" data-path="stepprotopype.html"><a href="stepprotopype.html"><i class="fa fa-check"></i><b>10</b> Building an “ipsum-app”</a></li>
<li class="part"><span><b>IV Step 3: Build</b></span></li>
<li class="chapter" data-level="11" data-path="stepbuild.html"><a href="stepbuild.html"><i class="fa fa-check"></i><b>11</b> Building app with <code>{golem}</code></a></li>
<li class="part"><span><b>V Step 4: Strengthen</b></span></li>
<li class="chapter" data-level="12" data-path="step-secure.html"><a href="step-secure.html"><i class="fa fa-check"></i><b>12</b> Build yourself a safety net</a></li>
<li class="chapter" data-level="13" data-path="secure.html"><a href="secure.html"><i class="fa fa-check"></i><b>13</b> Version Control</a></li>
<li class="chapter" data-level="14" data-path="deploy-golem.html"><a href="deploy-golem.html"><i class="fa fa-check"></i><b>14</b> Deploy your application</a></li>
<li class="part"><span><b>VI Optimizing</b></span></li>
<li class="chapter" data-level="15" data-path="when-optimize.html"><a href="when-optimize.html"><i class="fa fa-check"></i><b>15</b> The Need for Optimization</a></li>
<li class="chapter" data-level="16" data-path="optim-caveat.html"><a href="optim-caveat.html"><i class="fa fa-check"></i><b>16</b> Common Application Caveats</a></li>
<li class="chapter" data-level="17" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html"><i class="fa fa-check"></i><b>17</b> Optimizing Shiny Code</a></li>
<li class="chapter" data-level="18" data-path="optimjs.html"><a href="optimjs.html"><i class="fa fa-check"></i><b>18</b> Using JavaScript</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://rtask.thinkr.fr">A book by the ThinkR team</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Engineering Production-Grade Shiny Apps</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="optimjs" class="section level1">
<h1><span class="header-section-number">Chapter 18</span> Using JavaScript</h1>
<p>At its core, <strong>building a Shiny app is building a JavaScript application</strong> that can talk with an R session.
This process is invisible to most Shiny developers, who usually do everything in R, and in the end, this is the case: most of the Shiny apps out there are 100% written with R.</p>
<p>In fact, when you are writing UI elements in Shiny, <strong>what you are actually doing is building a series of HTML tags</strong>.</p>
<p>For example, this simple <code>{shiny}</code> code returns a series of HTML tags:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="optimjs.html#cb266-1"></a><span class="kw">fluidPage</span>(</span>
<span id="cb266-2"><a href="optimjs.html#cb266-2"></a>  <span class="kw">h2</span>(<span class="st">&quot;hey&quot;</span>), </span>
<span id="cb266-3"><a href="optimjs.html#cb266-3"></a>  <span class="kw">actionButton</span>(<span class="st">&quot;act&quot;</span>, <span class="st">&quot;Validate&quot;</span>)</span>
<span id="cb266-4"><a href="optimjs.html#cb266-4"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb267"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb267-1"><a href="optimjs.html#cb267-1"></a><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;container-fluid&quot;</span><span class="kw">&gt;</span></span>
<span id="cb267-2"><a href="optimjs.html#cb267-2"></a>  <span class="kw">&lt;h2&gt;</span>hey<span class="kw">&lt;/h2&gt;</span></span>
<span id="cb267-3"><a href="optimjs.html#cb267-3"></a>  <span class="kw">&lt;button</span><span class="ot"> id=</span><span class="st">&quot;act&quot;</span><span class="ot"> type=</span><span class="st">&quot;button&quot;</span><span class="ot"> class=</span><span class="st">&quot;btn btn-default action-button&quot;</span><span class="kw">&gt;</span>Validate<span class="kw">&lt;/button&gt;</span></span>
<span id="cb267-4"><a href="optimjs.html#cb267-4"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<p>Later on, when the app is launched, <code>{shiny}</code> binds events to UI elements, and these JavaScript events will communicate with R, in the sense that they will send data to R, and receive data from R.
Most of the time, when the JavaScript side of the websocket receives on of these events, the page the user sees is modified (for example, a plot is drawn).
On the R end of the websocket, <em>i.e</em> when R receives data from the web page, a value is fetched, and something is computed.</p>
<p>What happens under the hood is a little bit complex and out of scope for this book, but the general idea is: R talks to your browser through a web socket (that you can imagine as a small “phone line” with both software modules listening at each end<a href="#fn49" class="footnote-ref" id="fnref49"><sup>49</sup></a>), and this browser talks to R through the same web socket.</p>
<p>// TODO: create here a simple Flowchart</p>
<p>// R -&gt; (Web Socket) -&gt; JS</p>
<p>// R &lt;- (Web Socket) &lt;- JS</p>
<p>It’s important to note here that the <strong>communication happens in both ways</strong>: from R to JavaScript, and from JavaScript to R.
In fact, when we write a piece of code like <code>sliderInput("plop", "this", 1, 10, 5)</code>, what we are doing is creating a binding between JavaScript and R, where the JavaScript runtime (in the browser) listens to any event happening on the slider with the id <code>"plop"</code>, and whenever it detects that something happens to this element, something (most of the time its value) is sent back to R, and R does computation based on that value.
With <code>output$bla &lt;- renderPlot({})</code>, what we are doing is making the two communicate the other way around: we are telling JavaScript to listen to any incoming data from R for the <code>id</code> <code>"bla"</code>, and whenever JavaScript sees incoming data from R, it puts it into the proper HTML tag (here, JavaScript inserts the image received from R in the <code>&lt;img&gt;</code> tags with the id <code>bla</code>).</p>
<p>So even if everything is written with R, we <strong>are</strong> writing a web application, <em>i.e</em>. HTML, CSS and JavaScript elements.
Once you have realized that, the possibilities are endless: in fact almost anything doable in a “classic” web app can be done in Shiny with a little bit of tweaking.
What this also implies is that getting (even a little bit) better at writing HTML, CSS, and especially JavaScript will make your app better, lighter, and more user-friendly, as JavaScript is a language that has been designed to interact with a web page: change element appearances, hide and show things, click somewhere, show alerts and prompts…
<strong>Knowing just enough JavaScript can improve the quality of your app</strong>: especially when you have been using R to render some complex UIs: think conditional panels, simulating a button click from the server, hide and show elements…
All these things are good examples of where you should be using JavaScript instead of building more or less complex <code>renderUI</code> or <code>insertUI</code> patterns in your server.</p>
<p>Moreover, the number of JavaScript libraries available on the web is tremendous ; and the good news is that Shiny has everything it needs to bundle external JavaScript libraries inside your application<a href="#fn50" class="footnote-ref" id="fnref50"><sup>50</sup></a>.</p>
<p>This is what this section of the book aims at: giving you just enough JavaScript knowledge to lighten your Shiny App, in order to improve the global user and developer experience.
In this chapter, we will first review some JavaScript basics which can be used “client-side” only, i.e. only in your browser.
Then, we will talk about making R &amp; JS communicate with each other, and explore some common patterns for JavaScript in Shiny.
Finally, we will quickly present some of the functions available in <code>{golem}</code> that can be used to launch JavaScript.</p>
<blockquote>
<p>Note that this chapter does not try to be a comprehensive JavaScript course.
External resources are linked all throughout this chapter and at the end if you want to dive deeper into JavaScript.</p>
</blockquote>
<div id="a-quick-introduction-to-javascript" class="section level2">
<h2><span class="header-section-number">18.1</span> A quick introduction to JavaScript</h2>
<p>JavaScript is a programming language which has been designed to work in the browser<a href="#fn51" class="footnote-ref" id="fnref51"><sup>51</sup></a>.
There are three ways to include the JavaScript code inside your web app:</p>
<ul>
<li>As an external file, which is served to the browser alongside your main application page</li>
<li>Inside a <code>&lt;script&gt;</code> HTML tag inside your page</li>
<li>Inline, on a specific tag, for example by adding an <code>onclick</code> event straight on a tag</li>
</ul>
<blockquote>
<p>Note that the good practice when it comes to include JavaScript is to add the code inside an external file.</p>
</blockquote>
<p>If you are working with <code>{golem}</code>, including a JavaScript file is achieved via two functions:</p>
<ul>
<li><code>golem::add_js_file("name")</code>, which adds a standard JavaScript file, i.e. one which is not meant to be used to communicate with R.
We’ll see in the first part of this chapter how to add JavaScript code there.</li>
<li><code>golem::add_js_handler("name")</code>, which creates a file with a skeleton for Shiny handlers.
We’ll see this second type of elements in the <code>JavaScript &lt;-&gt; Shiny communication</code> part.</li>
</ul>
<p>OK, good, but what do we do now?
Note that in this chapter, we will not be covering basic JavaScript object and manipulation.
Feel free to refer to the first chapter of <a href="http://connect.thinkr.fr/js4shinyfieldnotes/intro.html">JavaScript 4 Shiny - Field Notes</a> for a detailed introduction to objects and object manipulation.</p>
<div id="understanding-html-class-and-id" class="section level3">
<h3><span class="header-section-number">18.1.1</span> Understanding html, class, and id</h3>
<p>You have to think of a web page as a tree, where the top of the webpage is the root node, and every element in the page is a node in this tree (this tree is called a DOM, for Document Object Model).
<strong>You can work on any of these HTML nodes with JavaScript</strong>: modify it, bind events to it and/or listen to events, hide and show…
But first, <strong>you have to find a way to identify these elements</strong>: either as a group of elements or as a unique element inside the whole tree.
That is what HTML semantic elements, classes, and ids are made for.
Consider this piece of code:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="optimjs.html#cb268-1"></a><span class="kw">library</span>(shiny)</span>
<span id="cb268-2"><a href="optimjs.html#cb268-2"></a><span class="kw">fluidPage</span>(</span>
<span id="cb268-3"><a href="optimjs.html#cb268-3"></a>  <span class="kw">titlePanel</span>(<span class="st">&quot;Hello Shiny&quot;</span>), </span>
<span id="cb268-4"><a href="optimjs.html#cb268-4"></a>  <span class="kw">actionButton</span>(<span class="st">&quot;go&quot;</span>, <span class="st">&quot;go&quot;</span>)</span>
<span id="cb268-5"><a href="optimjs.html#cb268-5"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb269"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb269-1"><a href="optimjs.html#cb269-1"></a><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;container-fluid&quot;</span><span class="kw">&gt;</span></span>
<span id="cb269-2"><a href="optimjs.html#cb269-2"></a>  <span class="kw">&lt;h2&gt;</span>Hello Shiny<span class="kw">&lt;/h2&gt;</span></span>
<span id="cb269-3"><a href="optimjs.html#cb269-3"></a>  <span class="kw">&lt;button</span><span class="ot"> id=</span><span class="st">&quot;go&quot;</span><span class="ot"> type=</span><span class="st">&quot;button&quot;</span><span class="ot"> class=</span><span class="st">&quot;btn btn-default action-button&quot;</span><span class="kw">&gt;</span>go<span class="kw">&lt;/button&gt;</span></span>
<span id="cb269-4"><a href="optimjs.html#cb269-4"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<p>This <code>{shiny}</code> code creates a piece of HTML code containing three nodes: a <code>div</code> with a specific class (a BootStrap container), an <code>h2</code>, which is a level-two header, and a button which has an id and a class.
Both are included in the <code>div</code>.
Let’s detail what we have got here:</p>
<ul>
<li>HTML tags, which are the building blocks of the “tree”: here <code>div</code>, <code>h2</code> and <code>button</code> are HTML tags.</li>
<li>The button has an <code>id</code>, which is short for “identifier”.
This id has to to be unique: this reference allows to refer to this exact element, and more specifically, it allows JavaScript and R to talk to each other: if you click on a button, you have to be sure you are referring to this specific button, and only that one.</li>
<li>Elements can have a class which can apply to multiple elements.
This can be used in JavaScript, but it is also very useful for styling elements in CSS.</li>
</ul>
</div>
<div id="querying-in-vanilla-javascript" class="section level3">
<h3><span class="header-section-number">18.1.2</span> Querying in Vanilla JavaScript</h3>
<p>In “Vanilla” JavaScript (i.e without any external plugin installed), you can query these elements using methods from the <code>document</code> object.
For example:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb270-1"><a href="optimjs.html#cb270-1"></a><span class="co">// Given</span></span>
<span id="cb270-2"><a href="optimjs.html#cb270-2"></a><span class="op">&lt;</span>div id <span class="op">=</span> <span class="st">&quot;pouet&quot;</span> name<span class="op">=</span><span class="st">&quot;plop&quot;</span> <span class="kw">class</span> <span class="op">=</span> <span class="st">&quot;plouf&quot;</span><span class="op">&gt;</span>Wesh&lt;/div<span class="op">&gt;</span></span>
<span id="cb270-3"><a href="optimjs.html#cb270-3"></a></span>
<span id="cb270-4"><a href="optimjs.html#cb270-4"></a><span class="co">// Query with the ID</span></span>
<span id="cb270-5"><a href="optimjs.html#cb270-5"></a><span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&quot;#pouet&quot;</span>)</span>
<span id="cb270-6"><a href="optimjs.html#cb270-6"></a><span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;pouet&quot;</span>)</span>
<span id="cb270-7"><a href="optimjs.html#cb270-7"></a></span>
<span id="cb270-8"><a href="optimjs.html#cb270-8"></a><span class="co">// With the class</span></span>
<span id="cb270-9"><a href="optimjs.html#cb270-9"></a><span class="va">document</span>.<span class="at">querySelectorAll</span>(<span class="st">&quot;.plouf&quot;</span>)</span>
<span id="cb270-10"><a href="optimjs.html#cb270-10"></a><span class="va">document</span>.<span class="at">getElementsByClassName</span>(<span class="st">&quot;plouf&quot;</span>) </span>
<span id="cb270-11"><a href="optimjs.html#cb270-11"></a></span>
<span id="cb270-12"><a href="optimjs.html#cb270-12"></a><span class="co">// With the name attribute</span></span>
<span id="cb270-13"><a href="optimjs.html#cb270-13"></a><span class="va">document</span>.<span class="at">getElementsByName</span>(<span class="st">&quot;plop&quot;</span>) </span>
<span id="cb270-14"><a href="optimjs.html#cb270-14"></a></span>
<span id="cb270-15"><a href="optimjs.html#cb270-15"></a><span class="co">// Using the tag name</span></span>
<span id="cb270-16"><a href="optimjs.html#cb270-16"></a><span class="va">document</span>.<span class="at">getElementsByTagName</span>(<span class="st">&quot;div&quot;</span>)</span></code></pre></div>
<p>Note that some of these methods have been introduced with ES6, which is a version of JavaScript that came out in 2015.
This version of JavaScript is supported by most browser since mid-2016 (and June 2017 for Firefox) (see <a href="https://www.w3schools.com/js/js_versions.asp">JavaScript Versions</a> from W3Schools).
Most of your users should now be using a browser version that is compatible with ES6, but that is something that you might want to keep in mind: browser version matters when it comes to using JavaScript.</p>
</div>
<div id="about-dom-events" class="section level3">
<h3><span class="header-section-number">18.1.3</span> About DOM events</h3>
<p>When users navigate a webpage, they are generating events on this page: clicking, hovering elements, pressing keys… all these are listened to by the JavaScript runtime, plus some events that are not generated by the users: for example, there is a “ready” event generated when the webpage has finished loading.
Most of these events are linked to a specific node in the tree: for example, if you click on something, you are clicking on a node in the DOM.
That is where JavaScript events come into play: when an event is triggered in JavaScript, you can link to it a “reaction”, in other word a piece of JavaScript code that is executed when this event occurs.</p>
<p>Here are some examples of events:</p>
<ul>
<li><p><code>click</code> / <code>dblclick</code></p></li>
<li><p><code>focus</code></p></li>
<li><p><code>keypress</code>, <code>keydown</code>, <code>keyup</code></p></li>
<li><p><code>mousedown</code>, <code>mouseenter</code>, <code>mouseleave</code>, <code>mousemove</code>, <code>mouseout</code>, <code>mouseover</code>, <code>mouseup</code></p></li>
<li><p><code>scroll</code></p></li>
</ul>
<p>For a full list, please refer to <a href="https://developer.mozilla.org/fr/docs/Web/Events" class="uri">https://developer.mozilla.org/fr/docs/Web/Events</a>.</p>
<p>Once you have this list in mind, you can then select elements in the DOM, then adding <code>addEventListener</code> to them, and defining a callback function: what happens when the event is triggered.
For example, the code below adds an event to the <code>input</code> when a key is pressed, showing a native <code>alert()</code> to the user.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb271-1"><a href="optimjs.html#cb271-1"></a><span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span> <span class="ot">=</span> <span class="st">&quot;plop&quot;</span><span class="kw">&gt;</span></span>
<span id="cb271-2"><a href="optimjs.html#cb271-2"></a><span class="kw">&lt;script&gt;</span> </span>
<span id="cb271-3"><a href="optimjs.html#cb271-3"></a>  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;plop&quot;</span>).<span class="at">addEventListener</span>(<span class="st">&quot;keypress&quot;</span><span class="op">,</span> <span class="kw">function</span>()<span class="op">{</span></span>
<span id="cb271-4"><a href="optimjs.html#cb271-4"></a>    <span class="at">alert</span>(<span class="st">&quot;pouet&quot;</span>)</span>
<span id="cb271-5"><a href="optimjs.html#cb271-5"></a>  <span class="op">}</span>)</span>
<span id="cb271-6"><a href="optimjs.html#cb271-6"></a><span class="kw">&lt;/script&gt;</span></span></code></pre></div>
<p>Note also that <code>Shiny</code> also generates events, meaning that you can customize the behavior of your application based on these events.
Here is a code that launches an alert when Shiny is connected:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb272-1"><a href="optimjs.html#cb272-1"></a><span class="at">$</span>(document).<span class="at">on</span>(<span class="st">&#39;shiny:connected&#39;</span><span class="op">,</span> <span class="kw">function</span>(event) <span class="op">{</span></span>
<span id="cb272-2"><a href="optimjs.html#cb272-2"></a>  <span class="at">alert</span>(<span class="st">&#39;Connected to the server&#39;</span>)<span class="op">;</span> </span>
<span id="cb272-3"><a href="optimjs.html#cb272-3"></a><span class="op">}</span>)<span class="op">;</span> </span></code></pre></div>
<p>But wait, what is this weird <code>$()</code>?
That’s <code>jQuery</code>, and we will discover it in the very next section!</p>
</div>
<div id="about-jquery-jquery-selectors" class="section level3">
<h3><span class="header-section-number">18.1.4</span> About <code>jQuery</code> &amp; <code>jQuery</code> selectors</h3>
<p>The <code>jQuery</code> framework is natively included in Shiny.</p>
<blockquote>
<p>jQuery is a fast, small, and feature-rich JavaScript library. It makes things like HTML document traversal and manipulation, event handling, animation, and Ajax much simpler with an easy-to-use API that works across a multitude of browsers.</p>
</blockquote>
<!--SHINY.SINGLETON[1efbbb1390b1f2da3adcc5776ac72d01ac3af14a]-->
<style>.right{ text-align: right;}</style>
<!--/SHINY.SINGLETON[1efbbb1390b1f2da3adcc5776ac72d01ac3af14a]-->
<div class="right">
<a href="https://jquery.com/">jQuery home page</a>
</div>
<p><code>jQuery</code> is a very popular JavaScript library which is designed to manipulate the DOM, its events and its elements.
It can be used to do a lot of things, like hide and show, change class, click somewhere…
And to be able to do that, it comes with the notion of selectors, which will be put between <code>$()</code>.
You can use, for example:</p>
<ul>
<li><p><code>$("#plop")</code> to refer to the element with the id <code>plop</code></p></li>
<li><p><code>$(".pouet")</code> to refer to element(s) of class <code>pouet</code></p></li>
<li><p><code>$("button:contains('this')")</code> to refer to the buttons with a text containing <code>'this'</code></p></li>
</ul>
<p>You can also use special HTML attributes, which are specific to a tag.
For example, the following HTML code:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb273-1"><a href="optimjs.html#cb273-1"></a><span class="kw">&lt;a</span><span class="ot"> href</span> <span class="ot">=</span> <span class="st">&quot;https://thinkr.fr&quot;</span><span class="ot"> data-value</span> <span class="ot">=</span> <span class="st">&quot;panel2&quot;</span><span class="kw">&gt;</span>ThinkR<span class="kw">&lt;/a&gt;</span></span></code></pre></div>
<p>contains the <code>href</code> &amp; <code>data-value</code> attributes.
You can refer to these with <code>[]</code> after the tag name.</p>
<ul>
<li><p><code>$("a[href = 'https://thinkr.fr']")</code> refers to link(s) with <code>href</code> being <code>https://thinkr.fr</code></p></li>
<li><p><code>$('a[data-value="panel2"]')</code> refers to link(s) with <code>data-value</code> being <code>"panel2"</code></p></li>
</ul>
<p>These and other selectors are <strong>used to identify one or more node(s) in the big tree which is a web page</strong>.
Once we have identified these elements, we can either extract or change data contained in these nodes, or invoke methods contained within these nodes.
Indeed JavaScript, as R, can be used as a functional language, but most of what we do is done in an object-oriented way.
In other words, you will interact with objects from the web page, and these objects will contain data and methods.</p>
<p>Note that this is not specific to <code>jQuery</code>: elements can also be selected with standard JavaScript.
<code>jQuery</code> has the advantage of simplifying selections and actions and to be cross-platform, making it easier to ship applications that can work on all major browsers.
And it comes with Shiny for free!</p>
<p>Choosing <code>jQuery</code> or vanilla JavaScript is up to you: and in the rest of this chapter we will try to mix both syntax, and put both when possible, so that you can choose the one you are the most comfortable with.</p>
</div>
</div>
<div id="client-side-javascript" class="section level2">
<h2><span class="header-section-number">18.2</span> Client-side JavaScript</h2>
<p>It is hard to give an exhaustive list of what you can do with JavaScript inside Shiny.
As a Shiny app is part JavaScript, part R, once you have a good grasp of JavaScript you can quickly enhance any of your applications.
That being said, a few common things can be done that would allow you to immediately optimize your application: i.e. small JavaScript functions that will prevent you from writing complex algorithmic logic in your application server.</p>
<div id="common-patterns" class="section level3">
<h3><span class="header-section-number">18.2.1</span> Common patterns</h3>
<ul>
<li><code>$('#id').show();</code> and <code>$('.class').hide();</code> show and hide one or more elements that match the given selector.
For example, this can be use to replace:</li>
</ul>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="optimjs.html#cb274-1"></a>output<span class="op">$</span>ui &lt;-<span class="st"> </span><span class="kw">renderUI</span>({</span>
<span id="cb274-2"><a href="optimjs.html#cb274-2"></a>  <span class="cf">if</span> (this){</span>
<span id="cb274-3"><a href="optimjs.html#cb274-3"></a>    <span class="kw">tags</span>(...)</span>
<span id="cb274-4"><a href="optimjs.html#cb274-4"></a>  } <span class="cf">else</span> {</span>
<span id="cb274-5"><a href="optimjs.html#cb274-5"></a>    <span class="ot">NULL</span></span>
<span id="cb274-6"><a href="optimjs.html#cb274-6"></a>  }</span>
<span id="cb274-7"><a href="optimjs.html#cb274-7"></a>})</span></code></pre></div>
<p>Note that this will not drastically improve the performance of your application.
Though it will help making it lighter in term of code and easier to grasp in term of readability: everything that can be created in the UI stays in the UI, and everything that needs to be performed by R is in the server.</p>
<ul>
<li><p><code>alert("message")</code> uses the built-in alert-box mechanism from the user’s browser (i.e., the <code>alert()</code> function is not part of <code>jQuery</code> but it is built inside the user’s browser).
It works well as it relies on the browser instead of relying on R or on a specific JavaScript library.
You can use this functionality to replace a call to <code>{shinyalert}</code>: the result is a little less aesthetically pleasing, but that is easier to implement and maintain.</p></li>
<li><p><code>var x = prompt("this", "that");</code> this function opens the built-in prompt, which is a text area where the user can input text.
With this code, when the user clicks “OK”, the text is stored in the <code>x</code> variable, which you can then send back to R (see further part down this chapter for more info on how to do that).
This can replace something like the following:</p></li>
</ul>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="optimjs.html#cb275-1"></a>mod &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb275-2"><a href="optimjs.html#cb275-2"></a>  <span class="kw">modalDialog</span>(</span>
<span id="cb275-3"><a href="optimjs.html#cb275-3"></a>    <span class="kw">tagList</span>(</span>
<span id="cb275-4"><a href="optimjs.html#cb275-4"></a>      <span class="kw">textInput</span>(<span class="kw">ns</span>(<span class="st">&quot;info&quot;</span>), <span class="st">&quot;Your info here&quot;</span>)</span>
<span id="cb275-5"><a href="optimjs.html#cb275-5"></a>    ),</span>
<span id="cb275-6"><a href="optimjs.html#cb275-6"></a>    <span class="dt">footer =</span> <span class="kw">tagList</span>(</span>
<span id="cb275-7"><a href="optimjs.html#cb275-7"></a>      <span class="kw">modalButton</span>(<span class="st">&quot;Cancel&quot;</span>),</span>
<span id="cb275-8"><a href="optimjs.html#cb275-8"></a>      <span class="kw">actionButton</span>(<span class="kw">ns</span>(<span class="st">&quot;ok&quot;</span>), <span class="st">&quot;OK&quot;</span>)</span>
<span id="cb275-9"><a href="optimjs.html#cb275-9"></a>    )</span>
<span id="cb275-10"><a href="optimjs.html#cb275-10"></a>  )</span>
<span id="cb275-11"><a href="optimjs.html#cb275-11"></a>}</span>
<span id="cb275-12"><a href="optimjs.html#cb275-12"></a></span>
<span id="cb275-13"><a href="optimjs.html#cb275-13"></a><span class="kw">observeEvent</span>(input<span class="op">$</span>show, {</span>
<span id="cb275-14"><a href="optimjs.html#cb275-14"></a>  <span class="kw">showModal</span>(<span class="kw">mod</span>())</span>
<span id="cb275-15"><a href="optimjs.html#cb275-15"></a>})</span>
<span id="cb275-16"><a href="optimjs.html#cb275-16"></a><span class="kw">observeEvent</span>(input<span class="op">$</span>ok, {</span>
<span id="cb275-17"><a href="optimjs.html#cb275-17"></a>  <span class="kw">removeModal</span>()</span>
<span id="cb275-18"><a href="optimjs.html#cb275-18"></a>})</span></code></pre></div>
<ul>
<li><p><code>$('#id').css('color', 'green');</code> / <code>document.getElementById("demo").style.color = "green";</code> changes the CSS attributes of the selected element(s).
Here, we are switching to green on the <code>#id</code> element.</p></li>
<li><p><code>$("#id").text("this)</code> / <code>document.getElementById("id").innerText = "this";</code> changes the text content to “this”.
This can be used to replace</p></li>
</ul>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="optimjs.html#cb276-1"></a>output<span class="op">$</span>ui &lt;-<span class="st"> </span><span class="kw">renderUI</span>({</span>
<span id="cb276-2"><a href="optimjs.html#cb276-2"></a>  <span class="cf">if</span> (this){</span>
<span id="cb276-3"><a href="optimjs.html#cb276-3"></a>    tags<span class="op">$</span><span class="kw">p</span>(<span class="st">&quot;First&quot;</span>)</span>
<span id="cb276-4"><a href="optimjs.html#cb276-4"></a>  } <span class="cf">else</span> {</span>
<span id="cb276-5"><a href="optimjs.html#cb276-5"></a>    tags<span class="op">$</span><span class="kw">p</span>(<span class="st">&quot;Second&quot;</span>)</span>
<span id="cb276-6"><a href="optimjs.html#cb276-6"></a>  }</span>
<span id="cb276-7"><a href="optimjs.html#cb276-7"></a>})</span></code></pre></div>
<ul>
<li><code>$("#id").remove();</code> / <code>var elem = document.querySelector('#some-element'); elem.parentNode.removeChild(elem);</code> completely removes the element from the DOM.
It can be used as a replacement for <code>shiny::removeUI()</code>, or as a conditional UI.</li>
</ul>
</div>
<div id="where-to-put-them---back-to-javascript-events" class="section level3">
<h3><span class="header-section-number">18.2.2</span> Where to put them - Back to JavaScript Events</h3>
<p>OK, now that we have got some ideas about JS code that can be used in Shiny, where do we put them?
HTML and JS have a concept called <code>events</code>, which are… well events that happen when the user manipulates the webpage: when the user clicks, hovers (the mouse goes over an element), presses the keyboard…
All these events can be used to trigger a JavaScript function.</p>
<p>Here are some examples of adding JavaScript functions to DOM events:</p>
<p>+<code>onclick</code></p>
<p>The <code>onclick</code> attribute can be added straight inside the HTML tag when possible:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="optimjs.html#cb277-1"></a>tags<span class="op">$</span><span class="kw">button</span>(</span>
<span id="cb277-2"><a href="optimjs.html#cb277-2"></a>  <span class="st">&quot;Show&quot;</span></span>
<span id="cb277-3"><a href="optimjs.html#cb277-3"></a>  <span class="dt">onclick =</span> <span class="st">&quot;$(&#39;#plot&#39;).show()&quot;</span></span>
<span id="cb277-4"><a href="optimjs.html#cb277-4"></a>)</span></code></pre></div>
<p>Or with <code>shiny::tagAppendAttributes</code>:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="optimjs.html#cb278-1"></a><span class="kw">plotOutput</span>(</span>
<span id="cb278-2"><a href="optimjs.html#cb278-2"></a>  <span class="st">&quot;plot&quot;</span></span>
<span id="cb278-3"><a href="optimjs.html#cb278-3"></a>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tagAppendAttributes</span>(</span>
<span id="cb278-4"><a href="optimjs.html#cb278-4"></a>  <span class="dt">onclick =</span> <span class="st">&quot;alert(&#39;hello world&#39;)&quot;</span></span>
<span id="cb278-5"><a href="optimjs.html#cb278-5"></a>)</span></code></pre></div>
<p>Here is for example a small Shiny app that implements this behavior:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="optimjs.html#cb279-1"></a><span class="kw">library</span>(shiny)</span>
<span id="cb279-2"><a href="optimjs.html#cb279-2"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb279-3"><a href="optimjs.html#cb279-3"></a>ui &lt;-<span class="st"> </span><span class="cf">function</span>(request){</span>
<span id="cb279-4"><a href="optimjs.html#cb279-4"></a>  <span class="kw">fluidPage</span>(</span>
<span id="cb279-5"><a href="optimjs.html#cb279-5"></a>    <span class="kw">plotOutput</span>(</span>
<span id="cb279-6"><a href="optimjs.html#cb279-6"></a>      <span class="st">&quot;plot&quot;</span></span>
<span id="cb279-7"><a href="optimjs.html#cb279-7"></a>    ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tagAppendAttributes</span>(</span>
<span id="cb279-8"><a href="optimjs.html#cb279-8"></a>      <span class="dt">onclick =</span> <span class="st">&quot;alert(&#39;iris plot!&#39;)&quot;</span></span>
<span id="cb279-9"><a href="optimjs.html#cb279-9"></a>    )</span>
<span id="cb279-10"><a href="optimjs.html#cb279-10"></a>  )</span>
<span id="cb279-11"><a href="optimjs.html#cb279-11"></a>}</span>
<span id="cb279-12"><a href="optimjs.html#cb279-12"></a></span>
<span id="cb279-13"><a href="optimjs.html#cb279-13"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session){</span>
<span id="cb279-14"><a href="optimjs.html#cb279-14"></a>  output<span class="op">$</span>plot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</span>
<span id="cb279-15"><a href="optimjs.html#cb279-15"></a>    <span class="kw">plot</span>(iris)</span>
<span id="cb279-16"><a href="optimjs.html#cb279-16"></a>  })</span>
<span id="cb279-17"><a href="optimjs.html#cb279-17"></a>}</span>
<span id="cb279-18"><a href="optimjs.html#cb279-18"></a></span>
<span id="cb279-19"><a href="optimjs.html#cb279-19"></a><span class="kw">shinyApp</span>(ui, server)</span></code></pre></div>
<p>You can find a real Life example of this <code>tagAppendAttributes</code> in the <code>{tidytuesday201942}</code> app:</p>
<ul>
<li><a href="https://github.com/ColinFay/tidytuesday201942/blob/master/R/mod_dataviz.R#L109">R/mod_dataviz.R#L109</a>, where the click on the plot generates the creation of a Shiny input (we will see this below)</li>
</ul>
<p>That, of course, works well with very small JavaScript code.
For longer JavaScript code, you can write a function inside and external file, and add it to your app.
In <code>{golem}</code>, this works by launching the <code>add_js_file("name")</code>, which will create a <code>.js</code> file.
The JavaScript file is then automatically linked in your application.</p>
<p>This, for example, could be:</p>
<ul>
<li>In <code>inst/app/www/script.js</code></li>
</ul>
<div class="sourceCode" id="cb280"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb280-1"><a href="optimjs.html#cb280-1"></a><span class="kw">function</span> <span class="at">alertme</span>(id)<span class="op">{</span></span>
<span id="cb280-2"><a href="optimjs.html#cb280-2"></a>  <span class="co">// Asking information</span></span>
<span id="cb280-3"><a href="optimjs.html#cb280-3"></a>  <span class="kw">var</span> name <span class="op">=</span> <span class="at">prompt</span>(<span class="st">&quot;Who are you?&quot;</span>)<span class="op">;</span></span>
<span id="cb280-4"><a href="optimjs.html#cb280-4"></a>  <span class="co">// Showing an alert</span></span>
<span id="cb280-5"><a href="optimjs.html#cb280-5"></a>  <span class="at">alert</span>(<span class="st">&quot;Hello &quot;</span> <span class="op">+</span> name <span class="op">+</span> <span class="st">&quot;! You&#39;re seeing &quot;</span> <span class="op">+</span> id)<span class="op">;</span></span>
<span id="cb280-6"><a href="optimjs.html#cb280-6"></a><span class="op">}</span></span></code></pre></div>
<ul>
<li>Then in R</li>
</ul>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="optimjs.html#cb281-1"></a><span class="kw">plotOutput</span>(</span>
<span id="cb281-2"><a href="optimjs.html#cb281-2"></a>  <span class="st">&quot;plot&quot;</span></span>
<span id="cb281-3"><a href="optimjs.html#cb281-3"></a>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tagAppendAttributes</span>(</span>
<span id="cb281-4"><a href="optimjs.html#cb281-4"></a>  <span class="dt">onclick =</span> <span class="st">&quot;alertme(&#39;plot&#39;)&quot;</span></span>
<span id="cb281-5"><a href="optimjs.html#cb281-5"></a>)</span></code></pre></div>
<p>Inside this <code>inst/app/www/script.js</code>, you can also attach a new behavior with <code>jQuery</code> to one or several elements.
For example, you can add this <code>alertme</code> / <code>onclick</code> behavior to all plots of the app:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb282-1"><a href="optimjs.html#cb282-1"></a><span class="kw">function</span> <span class="at">alertme</span>(id)<span class="op">{</span></span>
<span id="cb282-2"><a href="optimjs.html#cb282-2"></a>  <span class="kw">var</span> name <span class="op">=</span> <span class="at">prompt</span>(<span class="st">&quot;Who are you?&quot;</span>)<span class="op">;</span></span>
<span id="cb282-3"><a href="optimjs.html#cb282-3"></a>  <span class="at">alert</span>(<span class="st">&quot;Hello &quot;</span> <span class="op">+</span> name <span class="op">+</span> <span class="st">&quot;! You&#39;re seeing &quot;</span> <span class="op">+</span> id)<span class="op">;</span></span>
<span id="cb282-4"><a href="optimjs.html#cb282-4"></a><span class="op">}</span></span>
<span id="cb282-5"><a href="optimjs.html#cb282-5"></a></span>
<span id="cb282-6"><a href="optimjs.html#cb282-6"></a><span class="co">/* We&#39;re adding this so that the function is launched only</span></span>
<span id="cb282-7"><a href="optimjs.html#cb282-7"></a><span class="co">when the document is ready */</span></span>
<span id="cb282-8"><a href="optimjs.html#cb282-8"></a><span class="at">$</span>(<span class="kw">function</span>()<span class="op">{</span> </span>
<span id="cb282-9"><a href="optimjs.html#cb282-9"></a>  <span class="co">// Selecting all Shiny plots</span></span>
<span id="cb282-10"><a href="optimjs.html#cb282-10"></a>  <span class="at">$</span>(<span class="st">&quot;.shiny-plot-output&quot;</span>).<span class="at">on</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> <span class="kw">function</span>()<span class="op">{</span></span>
<span id="cb282-11"><a href="optimjs.html#cb282-11"></a>    <span class="co">/* Calling the alertme function with the id </span></span>
<span id="cb282-12"><a href="optimjs.html#cb282-12"></a><span class="co">    of the clicked plot */</span></span>
<span id="cb282-13"><a href="optimjs.html#cb282-13"></a>    <span class="at">alertme</span>(<span class="kw">this</span>.<span class="at">id</span>)<span class="op">;</span></span>
<span id="cb282-14"><a href="optimjs.html#cb282-14"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb282-15"><a href="optimjs.html#cb282-15"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>Then, all the plots from your app will receive this on-click event<a href="#fn52" class="footnote-ref" id="fnref52"><sup>52</sup></a>.</p>
<p>Note that there is a series of <code>Shiny events</code> which are specific to Shiny but that can be used just like the one we have just seen:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb283-1"><a href="optimjs.html#cb283-1"></a><span class="kw">function</span> <span class="at">alertme</span>()<span class="op">{</span></span>
<span id="cb283-2"><a href="optimjs.html#cb283-2"></a>  <span class="kw">var</span> name <span class="op">=</span> <span class="at">prompt</span>(<span class="st">&quot;Who are you?&quot;</span>)<span class="op">;</span></span>
<span id="cb283-3"><a href="optimjs.html#cb283-3"></a>  <span class="at">alert</span>(<span class="st">&quot;Hello &quot;</span> <span class="op">+</span> name <span class="op">+</span> <span class="st">&quot;! Welcome to my app&quot;</span>)<span class="op">;</span></span>
<span id="cb283-4"><a href="optimjs.html#cb283-4"></a><span class="op">}</span></span>
<span id="cb283-5"><a href="optimjs.html#cb283-5"></a></span>
<span id="cb283-6"><a href="optimjs.html#cb283-6"></a><span class="at">$</span>(<span class="kw">function</span>()<span class="op">{</span> </span>
<span id="cb283-7"><a href="optimjs.html#cb283-7"></a>  <span class="co">// Waiting for Shiny to be connected</span></span>
<span id="cb283-8"><a href="optimjs.html#cb283-8"></a>  <span class="at">$</span>(document).<span class="at">on</span>(<span class="st">&#39;shiny:connected&#39;</span><span class="op">,</span> <span class="kw">function</span>(event) <span class="op">{</span></span>
<span id="cb283-9"><a href="optimjs.html#cb283-9"></a>    <span class="at">alertme</span>()<span class="op">;</span></span>
<span id="cb283-10"><a href="optimjs.html#cb283-10"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb283-11"><a href="optimjs.html#cb283-11"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>See <a href="https://shiny.rstudio.com/articles/js-events.html">JavaScript Events in Shiny</a> for the full list of JavaScript events available in Shiny.</p>
</div>
</div>
<div id="javascript---shiny-communication" class="section level2">
<h2><span class="header-section-number">18.3</span> JavaScript &lt;-&gt; Shiny communication</h2>
<p>Now that we have seen some client-side optimization, i.e. R does not do anything with these events when they happen (in fact R is not even aware they happened), let’s now see how we can make these two communicate with each other.</p>
<div id="from-r-to-javascript" class="section level3">
<h3><span class="header-section-number">18.3.1</span> From R to JavaScript</h3>
<p>Calling JS from the server side (i.e from R) is done by defining a series of <code>CustomMessageHandler</code>: these are functions with one argument that can then be called using the <code>session$sendCustomMessage()</code> method from the server side.
Or if you are using <code>{golem}</code>, using the <code>invoke_js()</code> function.</p>
<p>You can define them using this skeleton:</p>
<pre><code>$( document ).ready(function() {
  Shiny.addCustomMessageHandler(&#39;fun&#39;, function(arg) {
  
  })
});</code></pre>
<p>This skeleton is the one generated by <code>golem::add_js_handler("plop")</code>.</p>
<p>Then, it can be called from server-side with:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="optimjs.html#cb285-1"></a>session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="st">&quot;fun&quot;</span>, <span class="kw">list</span>())</span>
<span id="cb285-2"><a href="optimjs.html#cb285-2"></a><span class="co"># OR</span></span>
<span id="cb285-3"><a href="optimjs.html#cb285-3"></a>golem<span class="op">::</span><span class="kw">invoke_js</span>(<span class="st">&quot;fun&quot;</span>, ...)</span></code></pre></div>
<p>Note that the <code>list()</code> argument from your function will be converted to JSON, and read as such from JavaScript.
In other words, if your have an argument called <code>x</code>, and you call the function with <code>list(a = 1, b = 12)</code>, then in JavaScript you will be able to use <code>x.a</code> and <code>x.b</code>.</p>
<p>For example:</p>
<ul>
<li>In <code>inst/app/www/script.js</code>:</li>
</ul>
<div class="sourceCode" id="cb286"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb286-1"><a href="optimjs.html#cb286-1"></a><span class="va">Shiny</span>.<span class="at">addCustomMessageHandler</span>(<span class="st">&#39;computed&#39;</span><span class="op">,</span> <span class="kw">function</span>(mess) <span class="op">{</span></span>
<span id="cb286-2"><a href="optimjs.html#cb286-2"></a>  <span class="at">alert</span>(<span class="st">&quot;Computed &quot;</span> <span class="op">+</span> <span class="va">mess</span>.<span class="at">what</span> <span class="op">+</span> <span class="st">&quot; in &quot;</span> <span class="op">+</span> <span class="va">mess</span>.<span class="at">sec</span> <span class="op">+</span> <span class="st">&quot; secs&quot;</span>)<span class="op">;</span></span>
<span id="cb286-3"><a href="optimjs.html#cb286-3"></a><span class="op">}</span>)</span></code></pre></div>
<ul>
<li>Then in R:</li>
</ul>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="optimjs.html#cb287-1"></a><span class="kw">observe</span>({</span>
<span id="cb287-2"><a href="optimjs.html#cb287-2"></a>  deb &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</span>
<span id="cb287-3"><a href="optimjs.html#cb287-3"></a>  <span class="co"># Do the computation for id</span></span>
<span id="cb287-4"><a href="optimjs.html#cb287-4"></a>  <span class="kw">Sys.sleep</span>(</span>
<span id="cb287-5"><a href="optimjs.html#cb287-5"></a>    <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb287-6"><a href="optimjs.html#cb287-6"></a>  )</span>
<span id="cb287-7"><a href="optimjs.html#cb287-7"></a>  session<span class="op">$</span><span class="kw">sendCustomMessage</span>(</span>
<span id="cb287-8"><a href="optimjs.html#cb287-8"></a>    <span class="st">&quot;computed&quot;</span>, </span>
<span id="cb287-9"><a href="optimjs.html#cb287-9"></a>    <span class="kw">list</span>(</span>
<span id="cb287-10"><a href="optimjs.html#cb287-10"></a>      <span class="dt">what =</span> <span class="st">&quot;plop&quot;</span>, </span>
<span id="cb287-11"><a href="optimjs.html#cb287-11"></a>      <span class="dt">sec =</span> <span class="kw">round</span>(<span class="kw">Sys.time</span>() <span class="op">-</span><span class="st"> </span>deb)</span>
<span id="cb287-12"><a href="optimjs.html#cb287-12"></a>    )</span>
<span id="cb287-13"><a href="optimjs.html#cb287-13"></a>  )</span>
<span id="cb287-14"><a href="optimjs.html#cb287-14"></a>})</span></code></pre></div>
</div>
<div id="from-javascript-to-r" class="section level3">
<h3><span class="header-section-number">18.3.2</span> From JavaScript to R</h3>
<p>How to do the other way around (from JavaScript to R)?
Shiny apps, in the browser, contain an object called <code>Shiny</code>, which can be used to send values to R, by creating an <code>InputValue</code>.
For example, with:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb288-1"><a href="optimjs.html#cb288-1"></a><span class="va">Shiny</span>.<span class="at">setInputValue</span>(<span class="st">&quot;rand&quot;</span><span class="op">,</span> <span class="va">Math</span>.<span class="at">random</span>())</span></code></pre></div>
<p>you will bind an input that can be caught from the server side with:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="optimjs.html#cb289-1"></a><span class="kw">observeEvent</span>( input<span class="op">$</span>rand , {</span>
<span id="cb289-2"><a href="optimjs.html#cb289-2"></a>  <span class="kw">print</span>( input<span class="op">$</span>rand )</span>
<span id="cb289-3"><a href="optimjs.html#cb289-3"></a>})</span></code></pre></div>
<p>This <code>Shiny.setInputValue</code> can of course be used inside any JavaScript function.
Here is a small example wrapping some of the things we have seen previously:</p>
<ul>
<li>In <code>inst/app/www/script.js</code></li>
</ul>
<div class="sourceCode" id="cb290"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb290-1"><a href="optimjs.html#cb290-1"></a><span class="kw">function</span> <span class="at">alertme</span>()<span class="op">{</span></span>
<span id="cb290-2"><a href="optimjs.html#cb290-2"></a>  <span class="kw">var</span> name <span class="op">=</span> <span class="at">prompt</span>(<span class="st">&quot;Who are you?&quot;</span>)<span class="op">;</span></span>
<span id="cb290-3"><a href="optimjs.html#cb290-3"></a>  <span class="at">alert</span>(<span class="st">&quot;Hello &quot;</span> <span class="op">+</span> name <span class="op">+</span> <span class="st">&quot;! Welcome to my app&quot;</span>)<span class="op">;</span></span>
<span id="cb290-4"><a href="optimjs.html#cb290-4"></a>  <span class="va">Shiny</span>.<span class="at">setInputValue</span>(<span class="st">&quot;username&quot;</span><span class="op">,</span> name)</span>
<span id="cb290-5"><a href="optimjs.html#cb290-5"></a><span class="op">}</span></span>
<span id="cb290-6"><a href="optimjs.html#cb290-6"></a></span>
<span id="cb290-7"><a href="optimjs.html#cb290-7"></a><span class="at">$</span>(<span class="kw">function</span>()<span class="op">{</span> </span>
<span id="cb290-8"><a href="optimjs.html#cb290-8"></a>  <span class="co">// Waiting for Shiny to be connected</span></span>
<span id="cb290-9"><a href="optimjs.html#cb290-9"></a>  <span class="at">$</span>(document).<span class="at">on</span>(<span class="st">&#39;shiny:connected&#39;</span><span class="op">,</span> <span class="kw">function</span>(event) <span class="op">{</span></span>
<span id="cb290-10"><a href="optimjs.html#cb290-10"></a>    <span class="at">alertme</span>()<span class="op">;</span></span>
<span id="cb290-11"><a href="optimjs.html#cb290-11"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb290-12"><a href="optimjs.html#cb290-12"></a>  </span>
<span id="cb290-13"><a href="optimjs.html#cb290-13"></a>  <span class="at">$</span>(<span class="st">&quot;.shiny-plot-output&quot;</span>).<span class="at">on</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> <span class="kw">function</span>()<span class="op">{</span></span>
<span id="cb290-14"><a href="optimjs.html#cb290-14"></a>    <span class="co">/* Calling the alertme function with the id </span></span>
<span id="cb290-15"><a href="optimjs.html#cb290-15"></a><span class="co">    of the clicked plot */</span></span>
<span id="cb290-16"><a href="optimjs.html#cb290-16"></a>    <span class="va">Shiny</span>.<span class="at">setInputValue</span>(<span class="st">&quot;last_plot_clicked&quot;</span><span class="op">,</span> <span class="kw">this</span>.<span class="at">id</span>)<span class="op">;</span></span>
<span id="cb290-17"><a href="optimjs.html#cb290-17"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb290-18"><a href="optimjs.html#cb290-18"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>These events (getting the user name and the last plot clicked), can then be caught from the server side with:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="optimjs.html#cb291-1"></a><span class="kw">observeEvent</span>( input<span class="op">$</span>username , {</span>
<span id="cb291-2"><a href="optimjs.html#cb291-2"></a>  cli<span class="op">::</span><span class="kw">cat_rule</span>(<span class="st">&quot;User name:&quot;</span>)</span>
<span id="cb291-3"><a href="optimjs.html#cb291-3"></a>  <span class="kw">print</span>(input<span class="op">$</span>username)</span>
<span id="cb291-4"><a href="optimjs.html#cb291-4"></a>})</span>
<span id="cb291-5"><a href="optimjs.html#cb291-5"></a></span>
<span id="cb291-6"><a href="optimjs.html#cb291-6"></a><span class="kw">observeEvent</span>( input<span class="op">$</span>last_plot_clicked , {</span>
<span id="cb291-7"><a href="optimjs.html#cb291-7"></a>  cli<span class="op">::</span><span class="kw">cat_rule</span>(<span class="st">&quot;Last plot clicked:&quot;</span>)</span>
<span id="cb291-8"><a href="optimjs.html#cb291-8"></a>  <span class="kw">print</span>(input<span class="op">$</span>last_plot_clicked)</span>
<span id="cb291-9"><a href="optimjs.html#cb291-9"></a>})</span></code></pre></div>
<p>Which will give:</p>
<pre><code>&gt; golex::run_app()
Loading required package: shiny

Listening on http://127.0.0.1:5495
── User name: ─────────────────────────────────────────────────────
[1] &quot;Colin&quot;
── Last plot clicked: ─────────────────────────────────────────────
[1] &quot;plota&quot;
── Last plot clicked: ─────────────────────────────────────────────
[1] &quot;plopb&quot;</code></pre>
<p><strong>Important note</strong>: if you are using modules, you will need to pass the namespacing of the <code>id</code> to be able to get it back from the server.
This can be done using the <code>session$ns</code> function, which comes by default in any golem-generated module.
In other words, you will need to write something like:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb293-1"><a href="optimjs.html#cb293-1"></a><span class="at">$</span>( document ).<span class="at">ready</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb293-2"><a href="optimjs.html#cb293-2"></a>  <span class="va">Shiny</span>.<span class="at">addCustomMessageHandler</span>(<span class="st">&#39;whoareyou&#39;</span><span class="op">,</span> <span class="kw">function</span>(arg) <span class="op">{</span></span>
<span id="cb293-3"><a href="optimjs.html#cb293-3"></a>    <span class="kw">var</span> name <span class="op">=</span> <span class="at">prompt</span>(<span class="st">&quot;Who are you?&quot;</span>)</span>
<span id="cb293-4"><a href="optimjs.html#cb293-4"></a>    <span class="va">Shiny</span>.<span class="at">setInputValue</span>(<span class="va">arg</span>.<span class="at">id</span><span class="op">,</span> name)<span class="op">;</span></span>
<span id="cb293-5"><a href="optimjs.html#cb293-5"></a>  <span class="op">}</span>)</span>
<span id="cb293-6"><a href="optimjs.html#cb293-6"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="optimjs.html#cb294-1"></a>mod_my_first_module_ui &lt;-<span class="st"> </span><span class="cf">function</span>(id){</span>
<span id="cb294-2"><a href="optimjs.html#cb294-2"></a>  ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id)</span>
<span id="cb294-3"><a href="optimjs.html#cb294-3"></a>  <span class="kw">tagList</span>(</span>
<span id="cb294-4"><a href="optimjs.html#cb294-4"></a>    <span class="kw">actionButton</span>(</span>
<span id="cb294-5"><a href="optimjs.html#cb294-5"></a>      <span class="kw">ns</span>(<span class="st">&quot;showname&quot;</span>), <span class="st">&quot;Enter your name&quot;</span></span>
<span id="cb294-6"><a href="optimjs.html#cb294-6"></a>    )</span>
<span id="cb294-7"><a href="optimjs.html#cb294-7"></a>  )</span>
<span id="cb294-8"><a href="optimjs.html#cb294-8"></a>}</span>
<span id="cb294-9"><a href="optimjs.html#cb294-9"></a></span>
<span id="cb294-10"><a href="optimjs.html#cb294-10"></a>mod_my_first_module_server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session){</span>
<span id="cb294-11"><a href="optimjs.html#cb294-11"></a>  ns &lt;-<span class="st"> </span>session<span class="op">$</span>ns</span>
<span id="cb294-12"><a href="optimjs.html#cb294-12"></a>  <span class="kw">observeEvent</span>( input<span class="op">$</span>showname , {</span>
<span id="cb294-13"><a href="optimjs.html#cb294-13"></a>    session<span class="op">$</span><span class="kw">sendCustomMessage</span>(</span>
<span id="cb294-14"><a href="optimjs.html#cb294-14"></a>      <span class="st">&quot;whoareyou&quot;</span>, </span>
<span id="cb294-15"><a href="optimjs.html#cb294-15"></a>      <span class="kw">list</span>(</span>
<span id="cb294-16"><a href="optimjs.html#cb294-16"></a>        <span class="dt">id =</span> <span class="kw">ns</span>(<span class="st">&quot;name&quot;</span>)</span>
<span id="cb294-17"><a href="optimjs.html#cb294-17"></a>      )</span>
<span id="cb294-18"><a href="optimjs.html#cb294-18"></a>    )</span>
<span id="cb294-19"><a href="optimjs.html#cb294-19"></a>  })</span>
<span id="cb294-20"><a href="optimjs.html#cb294-20"></a>  </span>
<span id="cb294-21"><a href="optimjs.html#cb294-21"></a>  <span class="kw">observeEvent</span>( input<span class="op">$</span>name , {</span>
<span id="cb294-22"><a href="optimjs.html#cb294-22"></a>    cli<span class="op">::</span><span class="kw">cat_rule</span>(<span class="st">&quot;Username is:&quot;</span>)</span>
<span id="cb294-23"><a href="optimjs.html#cb294-23"></a>    <span class="kw">print</span>(input<span class="op">$</span>name)</span>
<span id="cb294-24"><a href="optimjs.html#cb294-24"></a>  })</span>
<span id="cb294-25"><a href="optimjs.html#cb294-25"></a>}</span></code></pre></div>
<p>Another thing to note about this <code>id</code> creation is that you can generate <code>id</code> that are not defined in R beforehand.
For example, let’s create the code below:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="optimjs.html#cb295-1"></a><span class="kw">library</span>(shiny)</span>
<span id="cb295-2"><a href="optimjs.html#cb295-2"></a>ui &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb295-3"><a href="optimjs.html#cb295-3"></a>  <span class="kw">tagList</span>(</span>
<span id="cb295-4"><a href="optimjs.html#cb295-4"></a>    <span class="kw">h3</span>(<span class="st">&quot;No input in R&quot;</span>)</span>
<span id="cb295-5"><a href="optimjs.html#cb295-5"></a>  )</span>
<span id="cb295-6"><a href="optimjs.html#cb295-6"></a>}</span>
<span id="cb295-7"><a href="optimjs.html#cb295-7"></a></span>
<span id="cb295-8"><a href="optimjs.html#cb295-8"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb295-9"><a href="optimjs.html#cb295-9"></a>  input, </span>
<span id="cb295-10"><a href="optimjs.html#cb295-10"></a>  output, </span>
<span id="cb295-11"><a href="optimjs.html#cb295-11"></a>  session</span>
<span id="cb295-12"><a href="optimjs.html#cb295-12"></a>){</span>
<span id="cb295-13"><a href="optimjs.html#cb295-13"></a>  </span>
<span id="cb295-14"><a href="optimjs.html#cb295-14"></a>  <span class="kw">observeEvent</span>( input<span class="op">$</span>notfromr , {</span>
<span id="cb295-15"><a href="optimjs.html#cb295-15"></a>    <span class="kw">print</span>(input<span class="op">$</span>notfromr)</span>
<span id="cb295-16"><a href="optimjs.html#cb295-16"></a>  })</span>
<span id="cb295-17"><a href="optimjs.html#cb295-17"></a>  </span>
<span id="cb295-18"><a href="optimjs.html#cb295-18"></a></span>
<span id="cb295-19"><a href="optimjs.html#cb295-19"></a>}</span>
<span id="cb295-20"><a href="optimjs.html#cb295-20"></a></span>
<span id="cb295-21"><a href="optimjs.html#cb295-21"></a><span class="kw">shinyApp</span>(ui, server)</span></code></pre></div>
<p>Then, going into your developer console and typing <code>Shiny.setInputValue("notfromr", Math.random())</code> will print a random number in your console, event if this input wasn’t defined in your UI function.</p>
</div>
</div>
<div id="about-golem-js-functions" class="section level2">
<h2><span class="header-section-number">18.4</span> About <code>{golem}</code> js functions</h2>
<p><code>{golem}</code> comes with a series of JavaScript functions that you can call from the server.
These functions are added by default with <code>golem::activate_js()</code> in <code>app_ui</code>.</p>
<p>Then they are called with <code>golem::invoke_js("function", "element")</code>.</p>
<p>This <code>element</code> can be one of a series of elements (most of the time scalar elements) which can be used to select the DOM node you want to interact with.
It can be a full <code>jQuery</code> selector, an id or a class.
Note that you can pass multiple elements, with <code>invoke_js</code> <code>...</code> parameters</p>
<div id="goleminvoke_js" class="section level3">
<h3><span class="header-section-number">18.4.1</span> <code>golem::invoke_js()</code></h3>
<ul>
<li><code>showid</code> &amp; <code>hideid</code>, <code>showclass</code> &amp; <code>hideclass</code> show and hide elements using their id or class</li>
</ul>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="optimjs.html#cb296-1"></a>golem<span class="op">::</span><span class="kw">invoke_js</span>(<span class="st">&quot;showid&quot;</span>, <span class="kw">ns</span>(<span class="st">&quot;plot&quot;</span>))</span></code></pre></div>
<ul>
<li><code>showhref</code> &amp; <code>hidehref</code> hide and show a link by trying to match the <code>href</code> content</li>
</ul>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="optimjs.html#cb297-1"></a>golem<span class="op">::</span><span class="kw">invoke_js</span>(<span class="st">&quot;showhref&quot;</span>, <span class="st">&quot;panel2&quot;</span>)</span></code></pre></div>
<ul>
<li><p><code>clickon</code> click on the element, note that you have to use the full <code>jQuery</code> selector</p></li>
<li><p><code>show</code> &amp; <code>hide</code> show and hide elements, using the full <code>jQuery</code> selector</p></li>
</ul>
<p>See <code>?golem::activate_js</code> for a full list of built-in functions.</p>
</div>
</div>
<div id="learn-more-about-javascript" class="section level2">
<h2><span class="header-section-number">18.5</span> Learn more about JavaScript</h2>
<p>If you want to interact straight from R with NodeJS (JavaScript in the terminal), you can try the <code>{bubble}</code> package.
Be aware that you will need to have a working NodeJS installation on your machine.</p>
<p>It can be installed from GitHub</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="optimjs.html#cb298-1"></a>remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;ColinFay/bubble&quot;</span>)</span></code></pre></div>
<p>You can use in RMarkdown chunks, by setting the <code>{knitr}</code> engine:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="optimjs.html#cb299-1"></a>bubble<span class="op">::</span><span class="kw">set_node_engine</span>()</span></code></pre></div>
<p>Or straight in the command line with:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="optimjs.html#cb300-1"></a><span class="kw">node_repl</span>()</span></code></pre></div>
<p>Want to learn more?
Here is a list of external resources to learn more about JavaScript:</p>
<div id="shiny-javascript" class="section level3">
<h3><span class="header-section-number">18.5.1</span> Shiny &amp; JavaScript</h3>
<ul>
<li><p>We have written an online, freely available book about Shiny &amp; JavaScript: <a href="http://connect.thinkr.fr/js4shinyfieldnotes/">JavaScript 4 Shiny - Field Notes</a></p></li>
<li><p><a href="https://js4shiny.com/">JavaScript for Shiny Users</a>, companion website to the rstudio::conf(2020) workshop.</p></li>
<li><p><a href="https://shiny.rstudio.com/articles/building-inputs.html">Build custom input objects</a></p></li>
<li><p><a href="https://shiny.rstudio.com/articles/packaging-javascript.html">Packaging JavaScript code for Shiny</a></p></li>
<li><p><a href="https://shiny.rstudio.com/articles/communicating-with-js.html">Communicating with Shiny via JavaScript</a></p></li>
</ul>
</div>
<div id="javascript-basics" class="section level3">
<h3><span class="header-section-number">18.5.2</span> JavaScript basics</h3>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">Mozilla JavaScript</a></li>
<li><a href="https://www.w3schools.com/js/default.asp">w3schools JavaScript</a></li>
<li><a href="https://www.freecodecamp.org/">Free Code Camp</a></li>
<li><a href="http://jsforcats.com/">JavaScript For Cats</a></li>
<li><a href="https://www.learn-js.org/">Learn JS</a></li>
</ul>
</div>
<div id="jquery" class="section level3">
<h3><span class="header-section-number">18.5.3</span> jQuery</h3>
<ul>
<li><a href="https://learn.jquery.com/">jQuery Learning Center</a></li>
<li><a href="https://www.w3schools.com/jquery/default.asp">w3schools jQuery</a></li>
</ul>
</div>
<div id="intermediate-advanced-javascript" class="section level3">
<h3><span class="header-section-number">18.5.4</span> Intermediate / advanced JavaScript</h3>
<ul>
<li><a href="https://eloquentjavascript.net/">Eloquent JavaScript</a></li>
<li><a href="https://github.com/getify/You-Dont-Know-JS">You Don’t Know JS Yet</a></li>
</ul>

</div>
</div>
</div>
<hr/>
<footer>
<a href="rtask.thinkr.fr"><img src="img/logo400_129.png" alt="ThinkR Website"/></a>
</footer>
            </section>

          </div>
        </div>
      </div>
<a href="optimizing-shiny-code.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ThinkR-open/building-shiny-apps-workflow/edit/master/18-javascript.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
